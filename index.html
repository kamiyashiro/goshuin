<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>御朱印ジェネレーター（WebP版）</title>
<style>
  body {
    font-family: sans-serif;
    text-align: center;
    margin-top: 50px;
  }
  canvas {
    border: 2px solid #333;
  }
  button {
    margin-top: 20px;
    padding: 10px 20px;
    font-size: 16px;
    cursor: pointer;
  }
</style>
</head>
<body>

<h1>御朱印ジェネレーター（WebP版）</h1>
<canvas id="goshuinCanvas" width="500" height="500"></canvas><br>
<button id="generateBtn">御朱印生成</button>
<button id="downloadBtn">ダウンロード（WebP）</button>

<script>
// 御朱印テンプレート画像
const templateUrl = "KamiyashiroGoshuin.webp";

const canvas = document.getElementById("goshuinCanvas");
const ctx = canvas.getContext("2d");
const generateBtn = document.getElementById("generateBtn");
const downloadBtn = document.getElementById("downloadBtn");

function generateGoshuin() {
  const img = new Image();
  img.crossOrigin = "anonymous";
  img.src = templateUrl;
  img.onload = () => {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);

    // 日付描画
    const now = new Date();
    const yyyy = now.getFullYear();
    const mm = ("0" + (now.getMonth() + 1)).slice(-2);
    const dd = ("0" + now.getDate()).slice(-2);
    const dateStr = `${yyyy}年${mm}月${dd}日`;

    ctx.font = "24px serif";
    ctx.fillStyle = "red";
    ctx.textAlign = "right";
    ctx.fillText(dateStr, canvas.width - 20, canvas.height - 20);
  };
}

// ダウンロード（WebP）
function downloadGoshuin() {
  const link = document.createElement("a");
  link.download = "KamiyashiroGoshuin.webp";
  link.href = canvas.toDataURL("image/webp");
  link.click();
}

generateBtn.addEventListener("click", generateGoshuin);
downloadBtn.addEventListener("click", downloadGoshuin);
</script>

</body>
</html>
